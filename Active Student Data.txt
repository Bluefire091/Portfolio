SELECT DISTINCT
STUID, STU_CAREER, INSTITUTE, TERM, ADMISSON_TYPE, ADMISSON_TYPE_R,
CLASS, ACAD_PLAN, SCHOOL, DEPARTMENT,
SUM(CREDIT_HOURS),
(CASE WHEN CLASS <= '5' AND SUM(CREDIT_HOURS) < 12 THEN 'PART_TIME_UG'
			WHEN CLASS <= '5' AND SUM(CREDIT_HOURS) >= 12 THEN 'FULL_TIME_UG'
			WHEN CLASS >= '6' AND SUM(CREDIT_HOURS) < 9 THEN 'PART_TIME_GR'
			WHEN CLASS >= '6' AND SUM(CREDIT_HOURS) >= 9 THEN 'FULL_TIME_GR'
			ELSE 'CHECK' END) AS FULLPART_TIME,
CUMU_GPA, CURR_GPA,
FIRST_NAME, MIDDLE_NAME, LAST_NAME, PHONE_TYPE, PHONE,
EMAIL_ADDR, ADDRESS1, CITY, STATE, POSTAL, COUNTRY,
EFFDT, EFFSEQ, ACADEMIC_STANDING, ACADEMIC_STANDING_STATUS

FROM (
SELECT DISTINCT
A.STUID, A.STU_CAREER, A.TERM, A.CREDIT_HOURS, A.CLASS_NBR,
B.INSTITUTE, B.ADMISSON_TYPE, B.ACAD_PLAN,
(CASE WHEN B.ADMISSON_TYPE IN ('UF') THEN 'FTIC'
	WHEN B.ADMISSON_TYPE IN ('NT') THEN 'UG New Transfe'
	WHEN B.ADMISSON_TYPE IN ('NG', 'NGC', 'NGB') THEN 'New Grad'
	WHEN B.ADMISSON_TYPE IN ('DA') THEN 'Dual Admit'
	WHEN B.ADMISSON_TYPE IN ('TN') THEN 'Transient'
	ELSE 'Continuing' END) AS ADMISSON_TYPE_R,
(CASE WHEN ACAD_PLAN IN ('LAWJD') THEN 'College of Law'
	WHEN ACAD_PLAN IN ('CSIT-BA', 'ACCT-BBA', 'BSAN-BBA', 'BUND', 'BUSI-MBA', 'FINA-BBA', 'GNBU-BBA', 'HPMGT-BBA', 'HROB-BBA', 'LSCM-BS', 'MGMT-MMGT', 'SCMM-BBA') THEN 'School of Business'
	WHEN ACAD_PLAN IN ('CURI-MED', 'EDLE-MED', 'INDE-BS') THEN 'School of Education'
	WHEN ACAD_PLAN IN ('CDFS-BS', 'CLSC-MS', 'COUN-MED', 'COUN-MS', 'HSML-BS', 'PBHLT-BA', 'PBHLT-BS') THEN 'School of Human Services'
	WHEN ACAD_PLAN IN ('APAS-BAAS', 'APEN-BA', 'BIOL-BA', ‘BIOL-BS', 'CHEM-BA', 'CHEM-BS', 'COMM-BA', 'CRJS-BS', 'CRJS-MS', 'ESAC-BAAS', 'HIST-BA', 'JUSP-BA', 'MATH-BA', 'MATH-BS', 'PLDR-MS', 'POLS-BA', 'PSYC-BA', 'PSYC-BS', 'SOCI-BA', 'SPAN-BA', 'UNDECIDED', 'ESA-BAS', 'OESA-BAS') THEN 'School of Lib Arts & Sci'
	WHEN ACAD_PLAN IN ('UGCT-CRAN', 'UGCT-DMGT', 'UGCT-HOSP', 'UGCT-LSCM', 'UGCT-MEDI', 'UGCT-PRSS', 'UGCT-SUBAP') THEN 'Stand Alone UG Certificate'
	WHEN ACAD_PLAN IN ('GRD_LPCCM', 'GRD_PRNCP', 'GRD_SCEND', 'GRD_TCERT') THEN 'GR Certificate'
	WHEN ACAD_PLAN IN ('GNDE', 'GRAD PREP') THEN 'Post-Bacc and Undet'
	ELSE '' END) AS SCHOOL,
(CASE WHEN ACAD_PLAN IN ('LAWJD') THEN 'Law'
	WHEN ACAD_PLAN IN ('ACCT-BBA', 'BINA-BBA', 'BIND', 'BUSI-MBA', 'CSIT-BBA', 'FINA-BBA', 'GNBU-BBA', 'HPMGT-BBA', 'HROB-BBA', 'LSCM-BS', 'MGMT-MMGT', 'SCMM-BBA') THEN 'Business'
	WHEN ACAD_PLAN IN ('CURI-MED', 'EDLE-MED', 'INDE-BS') THEN 'Education'
	WHEN ACAD_PLAN IN ('CDFS-BS', 'CLSC-MS', 'COUN-MED', 'COUN-MS', 'HSML-BS', 'PBHLT-BA', 'PBHLT-BS') THEN 'Human Services'
	WHEN ACAD_PLAN IN ('COMM-BA') THEN 'Communication & Digital Media'
	WHEN ACAD_PLAN IN ('CRJS-BS', 'CRJS-MS', 'JUSP-BA', 'SOCI-BA', 'ESA-BAS', 'OESA-BAS') THEN 'Sociology and Criminal Justice'
	WHEN ACAD_PLAN IN ('HIST-BA', 'POLS-BA') THEN 'History and Political Science'
	WHEN ACAD_PLAN IN ('APAS-BAAS', 'ESAC-BAAS', 'DUNDECIDED') THEN 'Interdepartmental'
	WHEN ACAD_PLAN IN ('APEN-BA', 'SPAN-BA') THEN 'Languages AND Linguistics’
	WHEN ACAD_PLAN IN ('MATH-BA', 'MATH-BS') THEN 'Mathematics'
	WHEN ACAD_PLAN IN ('BIOL-BA', 'BIOL-BS', 'CHEM-BA', 'CHEM-BS') THEN 'Natural Sciences'
	WHEN ACAD_PLAN IN ('PSYC-BA', 'PSYC-BS') THEN 'Psychology'
	WHEN ACAD_PLAN IN ('PBHLT-BA', 'PBHLT-BS') THEN 'Public Health'
	WHEN ACAD_PLAN IN ('PLDR-MS') THEN 'Public Leadership and Admin'
	WHEN ACAD_PLAN IN ('AFFLGRND', 'AFFLUGND', 'DGRD_LPCCM', 'DGRD_PRNCP', 'DGRD_SCEND', 'DGRD_TCERT', 'UGCT-CRAN', 'UGCT-DMGT', 'UGCT-HOSP', 'UGCT-LSCM', 'UGCT-MEDI', 'UGCT-PRSS', 'UGCT-SUBAP') THEN 'Other'
	WHEN ACAD_PLAN IN ('DGNDE', 'DGRAD PREP') THEN 'Undetermined'
	ELSE '' END) AS DEPARTMENT,
(CASE WHEN B.ACADEMIC_LEVEL = '10' THEN '1'
  	WHEN B.ACADEMIC_LEVEL = '20' THEN '2'
	WHEN B.ACADEMIC_LEVEL = '30' THEN '3'
  	WHEN B.ACADEMIC_LEVEL = '40' THEN '4'
  	WHEN B.ACADEMIC_LEVEL = '50' THEN '5'
  	WHEN B.ACADEMIC_LEVEL = '60' THEN '6'
  	WHEN B.ACADEMIC_LEVEL IN ('SP1', 'SP4') THEN '8' END) AS CLASS,
(CASE WHEN B.ACADEMIC_LEVEL = '10' THEN 'Freshman'
  	WHEN B.ACADEMIC_LEVEL = '20' THEN 'Sophomore'
	WHEN B.ACADEMIC_LEVEL = '30' THEN 'Junior'
  	WHEN B.ACADEMIC_LEVEL = '40' THEN 'Senior'
  	WHEN B.ACADEMIC_LEVEL = '50' THEN 'Post-Bac'
  	WHEN B.ACADEMIC_LEVEL = '60' THEN 'Masters'
  	WHEN B.ACADEMIC_LEVEL IN ('SP1', 'SPF') THEN 'Spec-Prof'
END) AS CLASS_DESC,

C.PHONE_TYPE, C.PHONE,
D.CUM_GPA, D.CUR_GPA, D.TOT_ATTMPT_SCH, D.TOT_PASSD_SCH, D.TOT_TAKEN_GPA, D.TOT_PASSD_GPA,
E.EMAIL_ADDRESS,
F.ADDRESS, F.CITY, F.STATE, F.POSTAL_CODE, F.COUNTRY,
G.FIRST_NAME, G.MIDDLE_NAME, G.LAST_NAME,
H.EFFDT, H.EFFSEQ, H.ACADEMIC_STANDING, H.ACADEMIC_STANDING_STATUS,
I.DESCR

FROM PS_ENROLLMENT A
LEFT JOIN PS_ENROLLMENT_DTL B
	ON A.STUID = B.STUID
	AND A.INSTITUTE = B.INSTITUTE
	AND A.TERM = B.TERM
	AND A.STU_CAREER = B.STU_CAREER
LEFT JOIN PS_CONTACT_PHONE C
	ON A.STUID = C.STUID
	AND C.PHONE_TYPE = 'CELL'
LEFT JOIN PS_CAREER D
	ON A.STUID = D.STUID
	AND A.INSTITUTE = D.INSTITUTE
	AND A.STU_CAREER = D.STU_CAREER
	AND A.TERM = D.TERM
LEFT JOIN PS_CONTACT_EMAIL E
	ON A.STUID = E.STUID
	AND E.E_ADDR_TYPE = 'SCHOOL'
LEFT JOIN PS_CONTACT_ADDRESS F
	ON A.STUID=F.STUID
	AND F.ADDRESS_TYPE = 'MAIL'
	AND F.EFFDT = (SELECT MAX(F_ED.EFFDT)
			FROM PS_CONTACT_ADDRESS F_ED
			WHERE F.STUID=F_ED.STUID
			AND F.ADDRESS_TYPE=F_ED.ADDRESS_TYPE)
LEFT JOIN PS_FAMILY_NAME G
	ON A.STUID=G.STUID
	AND G.NAME_TYPE = 'PRI'
	AND G.EFFDT = (SELECT MAX(G_ED.EFFDT)
			FROM PS_FAMILY_NAME G_ED
			WHERE G.STUID = G_ED.STUID
			AND G.NAME_TYPE = G_ED.NAME_TYPE)
LEFT JOIN PS_ACADEMIC_STANDING H
	ON A.STUID = H.STUID
	AND A.INSTITUTE = H.INSTITUTE
	AND A.STU_CAREER = H.STU_CAREER
	AND H.EFFDT = (SELECT MAX(H2.EFFDT)
			FROM PS_ACADEMIC_STANDING H2
			WHERE H.STUID = H2.STUID
			AND H.STU_CAREER = H2.STU_CAREER
			AND H.INSTITUTE = H2.INSTITUTE)
	AND H.EFFSEQ = (SELECT MAX(H3.EFFSEQ)
			FROM PS_ACADEMIC_STANDING H3
			WHERE H.STUID = H3.STUID
			AND H.STU_CAREER = H3.STU_CAREER
			AND H.INSTITUTE = H3.INSTITUTE)
	AND H.TERM = (SELECT MAX(H4.TERM)
			FROM PS_ACADEMIC_STANDING H4
			WHERE H.STUID = H4.STUID
			AND H.STU_CAREER = H4.STU_CAREER
			AND H.INSTITUTE = H4.INSTITUTE)
LEFT JOIN PS_ACADEMIC_STANDING_DTL I
	ON H.ACADEMIC_STANDING = I.ACADEMIC_STANDING
	AND H.STU_CAREER = I.STU_CAREER

WHERE A.INSTITUTE = 'MAIN CAMPUS'
AND A.TERM IN ('FALL2024')
AND A.ENROLL_STATUS = 'Enrolled'

ORDER BY A.STUID
)
GROUP BY
STUID, STU_CAREER, INSTITUTE, TERM, ADMISSON_TYPE, ADMISSON_TYPE_R,
CLASS, ACAD_PLAN, SCHOOL, DEPARTMENT,
PHONE_TYPE, PHONE, CUMU_GPA, CURR_GPA,
FIRST_NAME, MIDDLE_NAME, LAST_NAME,
EMAIL_ADDRESS, ADDRESS, CITY, STATE, POSTAL_CODE, COUNTRY,
EFFDT, EFFSEQ, ACADEMIC_STANDING, ACADEMIC_STANDING_STATUS
ORDER BY STUID

